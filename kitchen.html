<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Kitchen Stock</title>
</head>
<body>
  <h2>Kitchen: Enter Ingredient Stock</h2>

  <div>
    <label>Ingredient 1:</label>
    <input type="text" id="name1" placeholder="Name">
    <input type="number" id="qty1" placeholder="Quantity">
  </div>
  <div>
    <label>Ingredient 2:</label>
    <input type="text" id="name2" placeholder="Name">
    <input type="number" id="qty2" placeholder="Quantity">
  </div>
  <div>
    <label>Ingredient 3:</label>
    <input type="text" id="name3" placeholder="Name">
    <input type="number" id="qty3" placeholder="Quantity">
  </div>

  <button onclick="saveStock()">Save Stock</button>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // Replace with your Firebase config
   const firebaseConfig = {
    apiKey: "AIzaSyCxnbO3nl9IzEOnkJnUYvBcjICAMaXWhHg",
    authDomain: "restaurant-realtime-b9a42.firebaseapp.com",
    projectId: "restaurant-realtime-b9a42",
    storageBucket: "restaurant-realtime-b9a42.firebasestorage.app",
    messagingSenderId: "357031222500",
    appId: "1:357031222500:web:54a63cc693f3f1325720f1"
  };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.saveStock = async function () {
      const ingredients = [
        { name: document.getElementById("name1").value.trim().toLowerCase(), qty: Number(document.getElementById("qty1").value) },
        { name: document.getElementById("name2").value.trim().toLowerCase(), qty: Number(document.getElementById("qty2").value) },
        { name: document.getElementById("name3").value.trim().toLowerCase(), qty: Number(document.getElementById("qty3").value) }
      ];

      const recipe = { rice: 0.25, oil: 0.05, veg: 0.20 };
      const counts = [];

      for (let ing of ingredients) {
        if (!ing.name || ing.qty <= 0) continue;
        await setDoc(doc(db, "ingredients", ing.name), { quantity: ing.qty });
        if (recipe[ing.name]) counts.push(Math.floor(ing.qty / recipe[ing.name]));
      }

      const available = counts.length ? Math.min(...counts) : 0;
      await setDoc(doc(db, "menu", "fried_rice"), { available });
      alert("Stock saved successfully");
    };
  </script>
</body>
</html>
